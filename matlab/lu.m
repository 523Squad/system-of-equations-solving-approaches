A = [
    [390, 201, 0, 0, 0, 0, 0, 0, 0, 0],
    [21, -135, -53, 0, 0, 0, 0, 0, 0, 0],
    [0, -271, 868, -203, 0, 0, 0, 0, 0, 0],
    [0, 0, -7, 596, 160, 0, 0, 0, 0, 0],
    [0, 0, 0, -47, -208, -96, 0, 0, 0, 0],
    [0, 0, 0, 0, -24, 347, -17, 0, 0, 0],
    [0, 0, 0, 0, 0, -96, 220, -40, 0, 0],
    [0, 0, 0, 0, 0, 0, 107, 546, -204, 0],
    [0, 0, 0, 0, 0, 0, 0, -301, -740, -364],
    [0, 0, 0, 0, 0, 0, 0, 0, 48, -154],
];

b = [
    [446],
    [62],
    [-783],
    [264],
    [-747],
    [-732],
    [-803],
    [-716],
    [-664],
    [-608],
];

function [L, U] = LU(A)
  n = size(A, 1);
  L = zeros(n, n);
  U = eye(n);
  for i = 1:n
    for j = 1:i
      L(i, j) = A(i, j) - sum(U(1:j-1, j) .* L(i, 1:j-1)');
    end;
    for j = i+1:n
      U(i, j) = (A(i, j) - sum(U(1:i-1, j) .* L(i, 1:i-1)')) / L(i, i);
    end;
  end;
end;

tic
[L, U] = LU(A)
toc
[_, y] = backward_left([L b]);
[_, x] = backward_right([U y'])
toc
